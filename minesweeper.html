<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Minesweeper - ThangMedia</title>
    <style>
        /* Retro computer monitor background */
        body {
            font-family: Arial, sans-serif;
            background: repeating-linear-gradient(
                0deg,
                #000 0px,
                #000 1px,
                #fff 1px,
                #fff 2px
            );
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        
        /* Window container */
        .window {
            background: white;
            border: 4px solid black;
            margin: 0 auto;
            max-width: 1200px;
            box-shadow: 0 0 0 2px #000;
        }
        
        /* Title bar with striped pattern */
        .title-bar {
            background: repeating-linear-gradient(
                90deg,
                #000 0px,
                #000 2px,
                #fff 2px,
                #fff 4px
            );
            border-bottom: 2px solid black;
            padding: 8px;
            display: table;
            width: 100%;
            box-sizing: border-box;
        }
        
        .title-bar-left {
            display: table-cell;
            width: 40px;
            vertical-align: middle;
        }
        
        .title-bar-center {
            display: table-cell;
            text-align: center;
            vertical-align: middle;
            color: white;
            font-weight: bold;
            font-size: 20px;
        }
        
        .title-bar-right {
            display: table-cell;
            width: 80px;
            text-align: right;
            vertical-align: middle;
        }
        
        .close-btn {
            width: 30px;
            height: 30px;
            background: white;
            border: 2px solid black;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: inline-block;
            line-height: 26px;
        }
        
        .close-btn:active {
            background: black;
            color: white;
        }
        
        .new-btn {
            background: white;
            border: 2px solid black;
            padding: 5px 10px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .new-btn:active {
            background: black;
            color: white;
        }
        
        /* Status bar */
        .status-bar {
            background: #ddd;
            border-bottom: 2px solid black;
            padding: 8px;
            display: table;
            width: 100%;
            box-sizing: border-box;
        }
        
        .status-left {
            display: table-cell;
            text-align: left;
            font-weight: bold;
            font-size: 16px;
        }
        
        .status-right {
            display: table-cell;
            text-align: right;
            font-weight: bold;
            font-size: 16px;
        }
        
        /* Game board area */
        .game-area {
            padding: 15px;
            background: white;
            overflow-x: auto;
        }
        
        #board {
            display: inline-block;
            border: 2px solid black;
            margin: 0 auto;
            background: #999;
            padding: 1px;
        }
        
        .row {
            display: block;
            white-space: nowrap;
        }
        
        .cell {
            width: 50px;
            height: 50px;
            background: white;
            border: 1px solid #999;
            display: inline-block;
            text-align: center;
            vertical-align: middle;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            line-height: 50px;
            margin: 0;
            padding: 0;
        }
        
        .cell.revealed {
            background: #ddd;
            color: black;
            border: 2px solid #666;
        }
        
        .cell.bomb {
            background: black;
            color: white;
        }
        
        .cell.flag {
            color: black;
        }
        
        /* Control bar */
        .control-bar {
            background: #ddd;
            border-top: 2px solid black;
            padding: 10px;
            text-align: center;
        }
        
        .dig-btn {
            background: white;
            border: 2px solid black;
            padding: 8px 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: inline-block;
        }
        
        .dig-btn:active {
            background: black;
            color: white;
        }
        
        .dig-btn.flag-mode {
            background: black;
            color: white;
        }
        
        .dig-icon {
            display: inline-block;
            margin-right: 5px;
            font-size: 18px;
        }
        
        .back-link {
            display: block;
            margin-top: 20px;
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
            border: 2px solid black;
            padding: 10px;
            background: white;
            color: black;
        }
    </style>
</head>
<body>

    <div class="window">
        <!-- Title Bar -->
        <div class="title-bar">
            <div class="title-bar-left">
                <div class="close-btn" onclick="window.location.href='index.html'">X</div>
            </div>
            <div class="title-bar-center">Minesweeper</div>
            <div class="title-bar-right">
                <button class="new-btn" onclick="initGame()">New</button>
            </div>
        </div>
        
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-left" id="gameStatus">ALIVE</div>
            <div class="status-right" id="minesCount">010</div>
        </div>
        
        <!-- Game Board -->
        <div class="game-area">
            <div id="board"></div>
        </div>
        
        <!-- Control Bar -->
        <div class="control-bar">
            <button class="dig-btn" id="digBtn" onclick="toggleMode()">
                <span class="dig-icon">‚õè</span>DIG
            </button>
        </div>
    </div>
    
    <a href="index.html" class="back-link">BACK TO HOME</a>

    <script>
        // C·∫•u h√¨nh
        var ROWS = 10;
        var COLS = 10;
        var MINES = 15;
        
        var grid = [];
        var gameOver = false;
        var isFlagMode = false; // False = DIG, True = FLAG
        var minesRemaining = MINES;
        
        function initGame() {
            var boardDiv = document.getElementById("board");
            boardDiv.innerHTML = "";
            minesRemaining = MINES;
            updateMinesCount();
            document.getElementById("gameStatus").innerText = "ALIVE";
            gameOver = false;
            grid = [];
            isFlagMode = false;
            updateDigButton();
            
            // T·∫°o l∆∞·ªõi d·ªØ li·ªáu
            for (var r = 0; r < ROWS; r++) {
                var row = [];
                var rowDiv = document.createElement("div");
                rowDiv.className = "row";
                for (var c = 0; c < COLS; c++) {
                    var cell = {
                        r: r, c: c,
                        isMine: false,
                        isOpen: false,
                        isFlag: false,
                        count: 0,
                        div: document.createElement("div")
                    };
                    cell.div.className = "cell";
                    
                    // X·ª≠ l√Ω s·ª± ki·ªán click
                    cell.div.onclick = (function(cellData){
                        return function() { handleClick(cellData); };
                    })(cell);

                    row.push(cell);
                    rowDiv.appendChild(cell.div);
                }
                grid.push(row);
                boardDiv.appendChild(rowDiv);
            }

            // R·∫£i m√¨n ng·∫´u nhi√™n
            var minesPlaced = 0;
            while (minesPlaced < MINES) {
                var rr = Math.floor(Math.random() * ROWS);
                var cc = Math.floor(Math.random() * COLS);
                if (!grid[rr][cc].isMine) {
                    grid[rr][cc].isMine = true;
                    minesPlaced++;
                }
            }

            // T√≠nh s·ªë m√¨n xung quanh
            for (var r = 0; r < ROWS; r++) {
                for (var c = 0; c < COLS; c++) {
                    if (!grid[r][c].isMine) {
                        grid[r][c].count = countMines(r, c);
                    }
                }
            }
        }

        function countMines(r, c) {
            var count = 0;
            for (var i = -1; i <= 1; i++) {
                for (var j = -1; j <= 1; j++) {
                    var nr = r + i, nc = c + j;
                    if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS) {
                        if (grid[nr][nc].isMine) count++;
                    }
                }
            }
            return count;
        }

        function toggleMode() {
            isFlagMode = !isFlagMode;
            updateDigButton();
        }
        
        function updateDigButton() {
            var btn = document.getElementById("digBtn");
            if (isFlagMode) {
                btn.innerHTML = '<span class="dig-icon">üö©</span>FLAG';
                btn.className = "dig-btn flag-mode";
            } else {
                btn.innerHTML = '<span class="dig-icon">‚õè</span>DIG';
                btn.className = "dig-btn";
            }
        }
        
        function updateMinesCount() {
            var flags = 0;
            for (var r = 0; r < ROWS; r++) {
                for (var c = 0; c < COLS; c++) {
                    if (grid[r] && grid[r][c] && grid[r][c].isFlag) {
                        flags++;
                    }
                }
            }
            var remaining = MINES - flags;
            document.getElementById("minesCount").innerText = 
                String(remaining).padStart(3, '0');
        }

        function handleClick(cell) {
            if (gameOver || (cell.isOpen && !isFlagMode)) return;

            if (isFlagMode) {
                // Ch·∫ø ƒë·ªô c·∫Øm c·ªù
                if (!cell.isOpen) {
                    cell.isFlag = !cell.isFlag;
                    cell.div.innerText = cell.isFlag ? "F" : "";
                    cell.div.className = cell.isFlag ? "cell flag" : "cell";
                    updateMinesCount();
                }
            } else {
                // Ch·∫ø ƒë·ªô ƒë√†o
                if (cell.isFlag) return; // Kh√¥ng ƒë√†o √¥ c√≥ c·ªù
                
                if (cell.isMine) {
                    revealMines();
                    document.getElementById("gameStatus").innerText = "DEAD";
                    gameOver = true;
                } else {
                    openCell(cell);
                    checkWin();
                }
            }
        }

        function openCell(cell) {
            if (cell.isOpen || cell.isFlag) return;
            cell.isOpen = true;
            cell.div.className = "cell revealed";
            
            if (cell.count > 0) {
                cell.div.innerText = cell.count;
            } else {
                // N·∫øu l√† √¥ tr·ªëng (0), m·ªü loang ra
                for (var i = -1; i <= 1; i++) {
                    for (var j = -1; j <= 1; j++) {
                        var nr = cell.r + i, nc = cell.c + j;
                        if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS) {
                            openCell(grid[nr][nc]);
                        }
                    }
                }
            }
        }

        function revealMines() {
            for (var r = 0; r < ROWS; r++) {
                for (var c = 0; c < COLS; c++) {
                    if (grid[r][c].isMine) {
                        grid[r][c].div.className = "cell bomb";
                        grid[r][c].div.innerText = "X";
                    }
                }
            }
        }

        function checkWin() {
            var openedCount = 0;
            for (var r = 0; r < ROWS; r++) {
                for (var c = 0; c < COLS; c++) {
                    if (grid[r][c].isOpen) openedCount++;
                }
            }
            if (openedCount === (ROWS * COLS - MINES)) {
                document.getElementById("gameStatus").innerText = "WIN!";
                gameOver = true;
            }
        }

        // B·∫Øt ƒë·∫ßu game khi t·∫£i trang
        initGame();
    </script>
</body>
</html>
